<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Quandary Layout Builder</title>
  <link rel="stylesheet" href="/styles.css" />
  <link rel="stylesheet" href="/layout-builder.css" />
</head>
<body>
  <header class="lb-header">
    <div class="lb-header-left">
      <button id="lb-back" class="lb-btn lb-btn-secondary" title="Back to Admin">‚Üê Admin</button>
      <h1 class="lb-title">Layout Builder</h1>
      <div id="lb-room-chip" class="lb-room-chip" aria-live="polite" title="Target room">No room selected</div>
    </div>
    <div class="lb-header-right">
      <button id="lb-validate" class="lb-btn lb-btn-ghost" title="Validate JSON">Validate</button>
      <button id="lb-export" class="lb-btn lb-btn-ghost" title="Export JSON">Export</button>
      <button id="lb-reset" class="lb-btn lb-btn-ghost" title="Reset layout">Reset</button>
      <button id="lb-save" class="lb-btn lb-btn-primary" title="Save to Room">Save to Room</button>
    </div>
  </header>

  <main class="lb-main" role="main">
    <!-- Palette -->
    <aside class="lb-panel lb-panel-left" aria-label="Palette">
      <section>
        <h2 class="lb-panel-title">Components</h2>
        <div class="lb-palette" id="lb-palette" aria-label="Draggable components" role="list">
          <div class="lb-palette-item" draggable="true" data-component="timer" role="listitem" tabindex="0">‚è±Ô∏è Timer</div>
          <div class="lb-palette-item" draggable="true" data-component="gameState" role="listitem" tabindex="0">üéÆ Game State</div>
          <div class="lb-palette-item" draggable="true" data-component="hints" role="listitem" tabindex="0">üí° Hints</div>
          <div class="lb-palette-item" draggable="true" data-component="navigation" role="listitem" tabindex="0">üß≠ Navigation</div>
          <div class="lb-palette-item" draggable="true" data-component="chat" role="listitem" tabindex="0">üí¨ Chat</div>
          <div class="lb-palette-item" draggable="true" data-component="media" role="listitem" tabindex="0">üñºÔ∏è Media</div>
        </div>
      </section>

      <section class="lb-colors">
        <h2 class="lb-panel-title">Color Scheme</h2>
        <div class="lb-form-row">
          <label for="color-primary">Primary</label>
          <input type="color" id="color-primary" value="#667eea" />
        </div>
        <div class="lb-form-row">
          <label for="color-secondary">Secondary</label>
          <input type="color" id="color-secondary" value="#764ba2" />
        </div>
        <div class="lb-form-row">
          <label for="color-accent">Accent</label>
          <input type="color" id="color-accent" value="#ff6b6b" />
        </div>
        <div class="lb-form-row lb-checkbox">
          <input type="checkbox" id="lb-darkmode" />
          <label for="lb-darkmode">Dark mode preview</label>
        </div>
        <div class="lb-actions">
          <button id="lb-apply-colors" class="lb-btn lb-btn-ghost">Apply</button>
        </div>
      </section>

      <section>
        <h2 class="lb-panel-title">Grid</h2>
        <div class="lb-form-row">
          <label for="lb-columns">Columns</label>
          <select id="lb-columns">
            <option value="12" selected>12</option>
            <option value="8">8</option>
            <option value="4">4</option>
          </select>
        </div>
        <div class="lb-form-row">
          <label for="lb-rows">Rows</label>
          <select id="lb-rows">
            <option value="6" selected>6</option>
            <option value="8">8</option>
            <option value="10">10</option>
          </select>
        </div>
        <div class="lb-form-row">
          <label for="lb-gap">Gap (px)</label>
          <input type="range" id="lb-gap" min="0" max="24" value="10" />
          <span id="lb-gap-val" class="lb-muted">10</span>
        </div>
      </section>
    </aside>

    <!-- Canvas -->
    <section class="lb-canvas-wrap" aria-label="Canvas">
      <div class="lb-canvas-toolbar">
        <div class="lb-hint">Drag components onto the grid. Click a block to edit span and position.</div>
        <div class="lb-toolbar-actions">
          <button id="lb-clear" class="lb-btn lb-btn-ghost" title="Clear canvas">Clear</button>
        </div>
      </div>

      <div id="lb-canvas" class="lb-canvas" role="grid" aria-label="Layout grid" aria-dropeffect="move">
        <!-- grid rows/cells generated by JS -->
      </div>

      <div class="lb-inspector" aria-live="polite">
        <div class="lb-inspector-row">
          <label for="insp-type">Type</label>
          <input id="insp-type" type="text" readonly />
        </div>
        <div class="lb-inspector-row">
          <label for="insp-row">Row</label>
          <input id="insp-row" type="number" min="1" />
        </div>
        <div class="lb-inspector-row">
          <label for="insp-col">Col</label>
          <input id="insp-col" type="number" min="1" />
        </div>
        <div class="lb-inspector-row">
          <label for="insp-span">Span</label>
          <input id="insp-span" type="number" min="1" />
        </div>
        <div class="lb-inspector-actions">
          <button id="insp-update" class="lb-btn lb-btn-ghost">Update</button>
          <button id="insp-delete" class="lb-btn lb-btn-ghost lb-danger">Delete</button>
        </div>
      </div>
    </section>

    <!-- Preview/Code -->
    <aside class="lb-panel lb-panel-right" aria-label="Preview and Code">
      <div class="lb-tabs" role="tablist">
        <button class="lb-tab active" data-tab="preview" role="tab" aria-selected="true">Preview</button>
        <button class="lb-tab" data-tab="json" role="tab" aria-selected="false">JSON</button>
        <button class="lb-tab" data-tab="code" role="tab" aria-selected="false">HTML/CSS</button>
      </div>
      <div class="lb-tab-panels">
        <div id="tab-preview" class="lb-tab-panel active" role="tabpanel" aria-label="Live Preview">
          <div id="lb-preview" class="lb-preview"></div>
        </div>
        <div id="tab-json" class="lb-tab-panel" role="tabpanel" aria-label="Layout JSON">
          <textarea id="lb-json" class="lb-code" spellcheck="false" aria-label="Layout JSON"></textarea>
        </div>
        <div id="tab-code" class="lb-tab-panel" role="tabpanel" aria-label="Generated HTML/CSS">
          <div class="lb-code-pair">
            <div>
              <div class="lb-code-title">HTML</div>
              <pre id="lb-html" class="lb-code" aria-label="Generated HTML"></pre>
            </div>
            <div>
              <div class="lb-code-title">CSS</div>
              <pre id="lb-css" class="lb-code" aria-label="Generated CSS"></pre>
            </div>
          </div>
        </div>
      </div>
      <div id="lb-status" class="lb-status" role="status" aria-live="polite"></div>
    </aside>
  </main>

  <script src="/socket.io/socket.io.js"></script>
  <script src="/theme-manager.js"></script>
  <script src="/layout-builder.js"></script>
</body>
</html>